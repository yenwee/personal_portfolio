<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 500" width="800" height="500">
  <defs>
    <marker id="arrow" viewBox="0 0 10 7" refX="10" refY="3.5" markerWidth="8" markerHeight="6" orient="auto-start-reverse">
      <path d="M 0 0 L 10 3.5 L 0 7 z" fill="rgba(255,255,255,0.4)"/>
    </marker>
    <marker id="arrow-red" viewBox="0 0 10 7" refX="10" refY="3.5" markerWidth="8" markerHeight="6" orient="auto-start-reverse">
      <path d="M 0 0 L 10 3.5 L 0 7 z" fill="rgba(244,63,94,0.6)"/>
    </marker>
    <linearGradient id="speed-grad-input" x1="0" y1="0" x2="1" y2="0">
      <stop offset="0%" stop-color="#22c55e"/>
      <stop offset="50%" stop-color="#f59e0b"/>
      <stop offset="100%" stop-color="#ef4444"/>
    </linearGradient>
  </defs>

  <!-- Background -->
  <rect width="800" height="500" rx="12" fill="#0f172a"/>

  <!-- Title -->
  <text x="24" y="30" font-family="system-ui, -apple-system, sans-serif" font-size="16" fill="white" opacity="0.9" font-weight="600">Sentinel Guardrails Architecture</text>
  <text x="24" y="48" font-family="system-ui, -apple-system, sans-serif" font-size="11" fill="rgba(255,255,255,0.4)">5-Layer Input + 4-Layer Output AI Safety Middleware</text>

  <!-- ==================== USER (Left) ==================== -->
  <circle cx="42" cy="180" r="24" fill="rgba(59,130,246,0.15)" stroke="#3b82f6" stroke-width="1.5"/>
  <text x="42" y="176" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="white" text-anchor="middle">User</text>
  <text x="42" y="188" font-family="system-ui, -apple-system, sans-serif" font-size="9" fill="rgba(255,255,255,0.5)" text-anchor="middle">Input</text>

  <!-- Arrow User -> Input Guard -->
  <line x1="66" y1="180" x2="88" y2="180" stroke="rgba(255,255,255,0.3)" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- ==================== INPUT GUARD (5 Layers) ==================== -->
  <rect x="90" y="72" width="310" height="216" rx="10" fill="rgba(244,63,94,0.04)" stroke="rgba(244,63,94,0.2)" stroke-width="1"/>
  <text x="245" y="90" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="rgba(255,255,255,0.5)" text-anchor="middle" font-weight="500">INPUT GUARD - 5 LAYERS</text>

  <!-- Speed gradient bar -->
  <rect x="110" y="94" width="270" height="3" rx="1.5" fill="url(#speed-grad-input)" opacity="0.6"/>
  <text x="118" y="108" font-family="system-ui, -apple-system, sans-serif" font-size="8" fill="#86efac">fast</text>
  <text x="370" y="108" font-family="system-ui, -apple-system, sans-serif" font-size="8" fill="#fca5a5" text-anchor="end">slow</text>

  <!-- Layer 1: URL Filter -->
  <rect x="104" y="114" width="80" height="48" rx="8" fill="rgba(34,197,94,0.12)" stroke="rgba(34,197,94,0.5)" stroke-width="1"/>
  <text x="144" y="134" font-family="system-ui, -apple-system, sans-serif" font-size="11" fill="white" text-anchor="middle">URL Filter</text>
  <rect x="118" y="140" width="52" height="16" rx="8" fill="rgba(34,197,94,0.2)"/>
  <text x="144" y="152" font-family="system-ui, -apple-system, sans-serif" font-size="9" fill="#86efac" text-anchor="middle">~1ms</text>

  <!-- Layer 2: Regex -->
  <rect x="192" y="114" width="70" height="48" rx="8" fill="rgba(34,197,94,0.10)" stroke="rgba(74,222,128,0.5)" stroke-width="1"/>
  <text x="227" y="134" font-family="system-ui, -apple-system, sans-serif" font-size="11" fill="white" text-anchor="middle">Regex</text>
  <rect x="205" y="140" width="44" height="16" rx="8" fill="rgba(74,222,128,0.2)"/>
  <text x="227" y="152" font-family="system-ui, -apple-system, sans-serif" font-size="9" fill="#86efac" text-anchor="middle">~2ms</text>

  <!-- Layer 3: BERT -->
  <rect x="270" y="114" width="56" height="48" rx="8" fill="rgba(245,158,11,0.12)" stroke="rgba(245,158,11,0.5)" stroke-width="1"/>
  <text x="298" y="134" font-family="system-ui, -apple-system, sans-serif" font-size="11" fill="white" text-anchor="middle">BERT</text>
  <rect x="274" y="140" width="48" height="16" rx="8" fill="rgba(245,158,11,0.2)"/>
  <text x="298" y="152" font-family="system-ui, -apple-system, sans-serif" font-size="9" fill="#fcd34d" text-anchor="middle">~150ms</text>

  <!-- Layer 4: LLM Judge -->
  <rect x="334" y="114" width="58" height="48" rx="8" fill="rgba(239,68,68,0.12)" stroke="rgba(239,68,68,0.5)" stroke-width="1"/>
  <text x="363" y="129" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="white" text-anchor="middle">LLM</text>
  <text x="363" y="141" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="white" text-anchor="middle">Judge</text>
  <rect x="343" y="147" width="40" height="14" rx="7" fill="rgba(239,68,68,0.2)"/>
  <text x="363" y="158" font-family="system-ui, -apple-system, sans-serif" font-size="9" fill="#fca5a5" text-anchor="middle">~2s</text>

  <!-- Connecting lines between input layers -->
  <line x1="184" y1="138" x2="192" y2="138" stroke="rgba(255,255,255,0.2)" stroke-width="1"/>
  <line x1="262" y1="138" x2="270" y2="138" stroke="rgba(255,255,255,0.2)" stroke-width="1"/>
  <line x1="326" y1="138" x2="334" y2="138" stroke="rgba(255,255,255,0.2)" stroke-width="1"/>

  <!-- Layer 5: Intent Scope (below) -->
  <rect x="104" y="172" width="288" height="42" rx="8" fill="rgba(244,63,94,0.10)" stroke="rgba(244,63,94,0.4)" stroke-width="1"/>
  <text x="200" y="197" font-family="system-ui, -apple-system, sans-serif" font-size="11" fill="white" text-anchor="middle">Intent Scope Validator</text>
  <rect x="318" y="181" width="62" height="18" rx="9" fill="rgba(245,158,11,0.2)"/>
  <text x="349" y="194" font-family="system-ui, -apple-system, sans-serif" font-size="9" fill="#fcd34d" text-anchor="middle">~500ms</text>

  <!-- Rejected path down -->
  <line x1="245" y1="214" x2="245" y2="250" stroke="rgba(244,63,94,0.5)" stroke-width="1.5" marker-end="url(#arrow-red)"/>
  <rect x="210" y="252" width="70" height="24" rx="12" fill="rgba(244,63,94,0.15)" stroke="rgba(244,63,94,0.5)" stroke-width="1"/>
  <text x="245" y="268" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#fb7185" text-anchor="middle">Blocked</text>

  <!-- Arrow Input Guard -> LLM -->
  <line x1="400" y1="180" x2="422" y2="180" stroke="rgba(255,255,255,0.3)" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- ==================== LLM (Center) ==================== -->
  <circle cx="464" cy="180" r="36" fill="rgba(139,92,246,0.15)" stroke="#8b5cf6" stroke-width="2"/>
  <text x="464" y="176" font-family="system-ui, -apple-system, sans-serif" font-size="14" fill="white" text-anchor="middle" font-weight="600">LLM</text>
  <text x="464" y="192" font-family="system-ui, -apple-system, sans-serif" font-size="9" fill="rgba(255,255,255,0.5)" text-anchor="middle">Core Model</text>

  <!-- Arrow LLM -> Output Guard -->
  <line x1="500" y1="180" x2="518" y2="180" stroke="rgba(255,255,255,0.3)" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- ==================== OUTPUT GUARD (4 Layers) ==================== -->
  <rect x="520" y="72" width="220" height="216" rx="10" fill="rgba(244,63,94,0.04)" stroke="rgba(244,63,94,0.2)" stroke-width="1"/>
  <text x="630" y="90" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="rgba(255,255,255,0.5)" text-anchor="middle" font-weight="500">OUTPUT GUARD - 4 LAYERS</text>

  <!-- Output Layer 1: Canary Token -->
  <rect x="534" y="102" width="88" height="40" rx="8" fill="rgba(244,63,94,0.10)" stroke="rgba(244,63,94,0.4)" stroke-width="1"/>
  <text x="578" y="118" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="white" text-anchor="middle">Canary</text>
  <text x="578" y="132" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="white" text-anchor="middle">Token</text>

  <!-- Output Layer 2: Persona Check -->
  <rect x="634" y="102" width="92" height="40" rx="8" fill="rgba(244,63,94,0.10)" stroke="rgba(244,63,94,0.4)" stroke-width="1"/>
  <text x="680" y="118" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="white" text-anchor="middle">Persona</text>
  <text x="680" y="132" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="white" text-anchor="middle">Check</text>

  <!-- Connect output row 1 -->
  <line x1="622" y1="122" x2="634" y2="122" stroke="rgba(255,255,255,0.2)" stroke-width="1"/>

  <!-- Output Layer 3: BERT + Topic -->
  <rect x="534" y="152" width="88" height="40" rx="8" fill="rgba(244,63,94,0.10)" stroke="rgba(244,63,94,0.4)" stroke-width="1"/>
  <text x="578" y="168" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="white" text-anchor="middle">BERT +</text>
  <text x="578" y="182" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="white" text-anchor="middle">Topic</text>

  <!-- Output Layer 4: LLM Judge -->
  <rect x="634" y="152" width="92" height="40" rx="8" fill="rgba(244,63,94,0.10)" stroke="rgba(244,63,94,0.4)" stroke-width="1"/>
  <text x="680" y="168" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="white" text-anchor="middle">LLM</text>
  <text x="680" y="182" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="white" text-anchor="middle">Judge</text>

  <!-- Connect output row 2 -->
  <line x1="622" y1="172" x2="634" y2="172" stroke="rgba(255,255,255,0.2)" stroke-width="1"/>

  <!-- Rejected path down from output -->
  <line x1="630" y1="216" x2="630" y2="250" stroke="rgba(244,63,94,0.5)" stroke-width="1.5" marker-end="url(#arrow-red)"/>
  <rect x="595" y="252" width="70" height="24" rx="12" fill="rgba(244,63,94,0.15)" stroke="rgba(244,63,94,0.5)" stroke-width="1"/>
  <text x="630" y="268" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#fb7185" text-anchor="middle">Blocked</text>

  <!-- Output Guard -> Safe Response -->
  <line x1="740" y1="180" x2="756" y2="180" stroke="rgba(255,255,255,0.3)" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- ==================== USER (Right) ==================== -->
  <circle cx="778" cy="180" r="18" fill="rgba(16,185,129,0.15)" stroke="#10b981" stroke-width="1.5"/>
  <text x="778" y="176" font-family="system-ui, -apple-system, sans-serif" font-size="9" fill="white" text-anchor="middle">Safe</text>
  <text x="778" y="186" font-family="system-ui, -apple-system, sans-serif" font-size="9" fill="white" text-anchor="middle">Output</text>

  <!-- ==================== BOTTOM: Details ==================== -->
  <rect x="16" y="310" width="768" height="172" rx="10" fill="rgba(255,255,255,0.02)" stroke="rgba(255,255,255,0.08)" stroke-width="1"/>
  <text x="400" y="332" font-family="system-ui, -apple-system, sans-serif" font-size="11" fill="rgba(255,255,255,0.5)" text-anchor="middle" font-weight="500">DEFENSE-IN-DEPTH STRATEGY</text>

  <!-- Fast layer group -->
  <text x="44" y="360" font-family="system-ui, -apple-system, sans-serif" font-size="11" fill="#86efac" font-weight="600">Fast Filters (&lt;10ms)</text>
  <text x="44" y="376" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="rgba(255,255,255,0.4)">URL blocklist, regex patterns</text>
  <text x="44" y="390" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="rgba(255,255,255,0.4)">Block 70% of attacks instantly</text>

  <!-- Medium layer group -->
  <text x="290" y="360" font-family="system-ui, -apple-system, sans-serif" font-size="11" fill="#fcd34d" font-weight="600">ML Classifiers (~150-500ms)</text>
  <text x="290" y="376" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="rgba(255,255,255,0.4)">BERT classifier, intent scope</text>
  <text x="290" y="390" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="rgba(255,255,255,0.4)">Semantic understanding layer</text>

  <!-- Deep layer group -->
  <text x="544" y="360" font-family="system-ui, -apple-system, sans-serif" font-size="11" fill="#fca5a5" font-weight="600">Deep Analysis (~2s)</text>
  <text x="544" y="376" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="rgba(255,255,255,0.4)">LLM judge for nuanced threats</text>
  <text x="544" y="390" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="rgba(255,255,255,0.4)">Catches adversarial prompts</text>

  <!-- Bottom stats -->
  <rect x="36" y="410" width="100" height="24" rx="12" fill="rgba(244,63,94,0.15)" stroke="rgba(244,63,94,0.4)" stroke-width="1"/>
  <text x="86" y="426" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#fb7185" text-anchor="middle">9 Guard Layers</text>

  <rect x="150" y="410" width="130" height="24" rx="12" fill="rgba(34,197,94,0.15)" stroke="rgba(34,197,94,0.4)" stroke-width="1"/>
  <text x="215" y="426" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#86efac" text-anchor="middle">Early-exit on block</text>

  <rect x="294" y="410" width="130" height="24" rx="12" fill="rgba(139,92,246,0.15)" stroke="rgba(139,92,246,0.4)" stroke-width="1"/>
  <text x="359" y="426" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#c4b5fd" text-anchor="middle">LangGraph Agents</text>

  <rect x="438" y="410" width="140" height="24" rx="12" fill="rgba(245,158,11,0.15)" stroke="rgba(245,158,11,0.4)" stroke-width="1"/>
  <text x="508" y="426" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#fcd34d" text-anchor="middle">Canary Token Detect</text>

  <!-- Architecture type pills bottom row -->
  <rect x="36" y="448" width="140" height="24" rx="12" fill="rgba(59,130,246,0.15)" stroke="rgba(59,130,246,0.4)" stroke-width="1"/>
  <text x="106" y="464" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#93c5fd" text-anchor="middle">FastAPI Middleware</text>

  <rect x="190" y="448" width="120" height="24" rx="12" fill="rgba(59,130,246,0.15)" stroke="rgba(59,130,246,0.4)" stroke-width="1"/>
  <text x="250" y="464" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#93c5fd" text-anchor="middle">Async Pipeline</text>

  <rect x="324" y="448" width="150" height="24" rx="12" fill="rgba(16,185,129,0.15)" stroke="rgba(16,185,129,0.4)" stroke-width="1"/>
  <text x="399" y="464" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#6ee7b7" text-anchor="middle">Progressive Escalation</text>
</svg>